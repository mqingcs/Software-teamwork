<import src="../common/foot.wxml" />
<view class="container">
  <view class="userinfo">
    <!-- 用户头像 -->
    <!-- open-type为微信小程序button组件的属性，可以使用封装好的功能 -->
    <!-- 头像信息为空显示修改头像按钮，否则显示头像图片-->
    <button wx:if="{{!userInfo.avatarUrl}}" class="avatar-wrapper" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
      修改头像
    </button>
    <image class="userinfo-avatar" src="{{userInfo.avatarUrl}}" background-size="cover" wx:if="{{userInfo.avatarUrl}}"></image>

    <!-- 用户昵称输入框，带有确认按钮 -->
    <!-- 没有用户昵称显示输入框，否则显示昵称文本 -->
    <view class="nickname-input-wrapper" wx:if="{{!hasUserInfo}}">
      <input type="nickname" class="nick-name-input" placeholder="请输入昵称" bindinput="changeNickName" bindblur="onNickNameBlur" />
      <button wx:if="{{showConfirmButton}}" bindtap="confirmNickName" class="confirm-button small-button">确认</button>
    </view>

    <!-- 显示已填写的昵称 -->
    <text class="userinfo-nickname" wx:if="{{hasUserInfo}}">{{userInfo.nickName}}的私人账本</text>
  </view>

  <view>
    <modal title="新建一个账目" hidden="{{modalHidden1}}" confirm-text="确定" cancel-text="取消" bindconfirm="modalBindaconfirm1" bindcancel="modalBindcancel1">
      <input name='title' bindblur="setTitle" placeholder="起一个响亮的名字吧" value="{{temptitle}}">
      </input>
    </modal>
    <modal title="账目重命名" hidden="{{modalHidden2}}" confirm-text="确定" cancel-text="取消" bindconfirm="modalBindaconfirm2" bindcancel="modalBindcancel2">
      <input name='title' bindblur="setTitle" placeholder="起一个响亮的名字吧" value="{{temptitle}}">
      </input>
    </modal>
  </view>

  <view class="page-body">
    <view class="index-bd">
      <view class="touch-item {{item.isTouchMove ? 'touch-move-active' : ''}}" data-index="{{index}}" bindtouchstart="touchstart" bindtouchmove="touchmove" wx:for="{{list}}" wx:key="id">
        <view class="content">
          <navigator url="../handbook/index/index?index={{index}}" class="navigator">
            <view class="navigator-text">{{item.title}}</view>
            <view class="navigator-arrow"></view>
          </navigator>
        </view>
        <view class="rename" catchtap="showModal2" data-index="{{index}}">重命名</view>
        <view class="del" catchtap="del" data-index="{{index}}">删除</view>
      </view>
    </view>

    <view bindtap="showModal1">
      <image class="float-action2" src="../common/icon/add.png"></image>
    </view>

    <view>
      <navigator url="../settings/settings" hover-class="navigator-hover">
        <image class="float-action" src="../common/icon/setting.png"></image>
      </navigator>
    </view>
  </view>

  <template is="foot" />
</view>